language: generic
sudo: required
branches:
  except:
    - /^v[0-9]*/
before_script:
- sudo add-apt-repository ppa:koffeinflummi/armake -y
- sudo apt-get update -y
- sudo apt-get install armake -y
script:
- export VERSION=`cat description.ext  | grep -o 'onLoadName = ".*"' | grep -o 'v[0-9.][0-9.]*'`
- armake build -w unquoted-string -w redefinition-wo-undef -w excessive-concatenation -x ".*" -x "*.pbo" -x "*.md" . 7Cav_FullSpectrum_$VERSION.chernarus.pbo
- git tag $VERSION
deploy:
  if:
    branch: master
  provider: releases
  skip_cleanup: true
  file: '7Cav_FullSpectrum_$VERSION.chernarus.pbo'
  on:
    branch: master
    repo: 7Cav/7Cav_FullSpectrum_V4.chernarus
  name: '7th Cavalry Full Spectrum $VERSION - chernarus'
  api_key:
    secure: qmO7QRpZA8wDjRezSrzNc8dzJKa2qLgR1P4glsAsFiUhlOAn9sDMGEAcLeDqkkM6LVSgIXUnxQy6B4fbGgfuy+uENHRzh0jbTDd2/NVKPVIZldhyfcER1Pv3gVur3uSwJ7MyGpXX9LYjOm13I2hBG9RAQJktMb3KdfGjKIEHEG2tBEkT0nzschG/zDgY12770cO87SzYYyZF/ucFfsrA5fUY35na5riJVD66975+9bTOWeXCEpm8ZGj/rX23sLrLNqzvAbS/hC9OdbDSlQNiWYX3qQZ/rhfFU58syubxAWYNLReqOwXRT8lehZVld2oWsyt3Ns0rKjqTLYwslltiy4HfyJDhJONkFY+urDle4Altz0MUnyhSZ1Q3BmTmUWNCcGtDRzaIFhznL2QUx+WOLlS2Gr7M0RakC9XLlVC/Pr8hDDK+HhkNBD88ZgRMFCNFw0qS/NCKc3b40wfINTLK4xugfs3aUxwN7kNWX2UoBGC6NiFbjAPk0YpUo8jVgEDMBJzLnmVVPt2yBxnsvTPwJVslbr8gc2iqRLQkgozbrrd0UjoM7Lmnx+9CcgOlC9msQHVEHgyhyahXw3nZfZeDW9vuuST6fndueXPaCLrmkIFI7I7IM09LC4ikkZts0poBTwCrhqKxA50yRjeW86tSROMQXKbHg/2+TYAzQk4Y7o8=
