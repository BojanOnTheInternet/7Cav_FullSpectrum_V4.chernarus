language: generic
sudo: required
branches:
  except:
    - /^v[0-9]*/
before_script:
- sudo add-apt-repository ppa:koffeinflummi/armake -y
- sudo apt-get update -y
- sudo apt-get install armake -y
script:
- export VERSION=`cat description.ext  | grep -o 'onLoadName = ".*"' | grep -o 'v[0-9.][0-9.]*'`
- armake build -w unquoted-string -w redefinition-wo-undef -w excessive-concatenation -x ".*" -x "*.pbo" -x "*.md" . 7Cav_FullSpectrum_$VERSION.chernarus.pbo
- git tag $VERSION
deploy:
  if:
    branch: master
  provider: releases
  skip_cleanup: true
  file: '7Cav_FullSpectrum_$VERSION.chernarus.pbo'
  on:
    branch: master
    repo: 7Cav/7Cav_FullSpectrum_V4.chernarus
  name: '7th Cavalry Full Spectrum $VERSION - chernarus'
  api_key:
    secure: PP+67xxM6wcDVmZQr7Jtn91g8BAxh4evBJW0IS20Z32xJ8zig9oEZWLiCDqsRGh6aO7w1M/hm2bZJ5h9GNqHUFrJ6Nd5xkyzZw2Rm6FfUVjebHOwmqTDcIS72zzI0eqG6VL9eksfe473RZx298J4jmfx4WpxcIVvfK6HBJSF2gDiEVvIifg/051IljOnmSNojCt1WHvsElX5UdV9mEbcJWw/Q6S7tDX6QJJE0UCHAKQKhMZVVQ7d+Yn2AnHQxKSnrmbto48LNCdMw+Vpg+QNQf0qTXvjulemnQLwjgED2J7YjT6OgnXPPxcSiRCWhK+tZqxJFi+XM9kAjowdcW0fIDiZXDEShrX78GNC6+AxseOSBh82/zCdGifpYmWt3S19D68CceP808vwAJnaE8BjIvYlURSErpLTWy+XY3dk2RxXbpvL4mBXfqo5simja/Dk3WHNGqt91hjrWRUu5NSmWxWNcBjHSoXphUnq8cWygvcV3tN1iA4THw2FwoOCEIfTI+Z7Yx+xeX7k3/fljzoEnnwsMma50GjtQcU6huQ7I6nkxMtKs/tEYh/9F4b424VDSt+I+J2VirxlcODoIY8uQmcBz2j1RomMO6wBwTueyk8D1p5OVGpgh9KM6AMtpfxkrktJe/PgymdmlOYzlGEU26lYapbt3M3ueNvSuIHwUKk=
