language: generic
sudo: required
branches:
  except:
    - /^v[0-9]*/
before_script:
- sudo add-apt-repository ppa:koffeinflummi/armake -y
- sudo apt-get update -y
- sudo apt-get install armake -y
script:
- export VERSION=`cat description.ext  | grep -o 'onLoadName = ".*"' | grep -o 'v[0-9.][0-9.]*'`
- armake build -w unquoted-string -w redefinition-wo-undef -w excessive-concatenation -x ".*" -x "*.pbo" -x "*.md" . 7Cav_FullSpectrum_$VERSION.chernarus.pbo
- git tag $VERSION
deploy:
  if:
    branch: master
  provider: releases
  skip_cleanup: true
  file: '7Cav_FullSpectrum_$VERSION.chernarus.pbo'
  on:
    branch: master
    repo: 7Cav/7Cav_FullSpectrum_V4.chernarus
  name: '7th Cavalry Full Spectrum $VERSION - chernarus'
  api_key:
    secure: Sv2CCUGW96f8Sk7TPKHHTccfLcB5m0T2l+qBjpiagvc75PQcgVbqsNVyA2hBxfetpynlpLP17cn5B0vVmrGl1TyF/Ijqn9/Yzf1jYngUt081eaNo6vn5S49hnZVfe3oODQM8snjDo1yBWSWZmv1AiTsj7W7bhoKIlaJq5kkfpNtIWslhEDU5uF/KI9ha3L5tkU+qdFnGOiMParzHeoV8WLtHiJqK/9ONZkSzXHidhHp7tDE4ENkJW/hPAJ7v248+7ujKXo/xr2M9QYGe9tNJR1Fx5ZvVkNy9GHE8fMBanfBdn0IJMltf0B3+XnRRUS3ErSE3fQl7+PhRddTiZKmCcTN32+J6NLO6y0s67D+aAvuKL3jZb2YMYwrH9ExOPglQzHcx69tWsf3mP7aHPPrBI50ViG8Z4SprRhOeOO6qqFgE2AOOE83F9cWSI55M1turGtyeDjgDDdJ9hkD0iChWhngs288WlpDR45dY/62McVxstXxCLwZwE67L9xaU8EWQcTIPb7N3zpzGXtDnAujsRn5oZnOOD+bU9aFi3CMDQ3DyvO9W/t/0HlbYm1voTHLLTOT7CALuYjaCwhq3PpFXK2umYyg17SYsM4vDSpPsWuXG0XkBspV3rU9YJK2KURbGtWMgUgUghzWQxEj6EZtqgFbmsCp3BTq5HSHtGkbTBeU=
